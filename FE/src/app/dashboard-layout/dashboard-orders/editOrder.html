<div class="container mt-4" *ngIf="orderForm">
  <h4 class="fw-bold mb-3">‚úèÔ∏è Ch·ªânh s·ª≠a ƒë∆°n h√†ng</h4>

  <form [formGroup]="orderForm" (ngSubmit)="submit()">
    <div class="row g-4">
      <!-- Ng∆∞·ªùi g·ª≠i + Pickup -->
      <div class="col-md-6">
        <div class="mb-3">
          <label class="form-label fw-semibold">Ng∆∞·ªùi g·ª≠i</label>
          <input type="text" class="form-control" formControlName="senderName" placeholder="Nh·∫≠p t√™n ng∆∞·ªùi g·ª≠i" />
        </div>

        <div class="mb-3">
          <label class="form-label fw-semibold">ƒê·ªãa ch·ªâ l·∫•y h√†ng</label>
          <select class="form-select mb-2" formControlName="pickupProvinceId" (change)="onPickupProvinceChange()">
            <option value="">-- Ch·ªçn t·ªânh/th√†nh ph·ªë --</option>
            <option *ngFor="let p of provinces" [value]="p._id">{{ p.name }}</option>
          </select>

          <select class="form-select mb-2" formControlName="pickupCommuneId">
            <option value="">-- Ch·ªçn qu·∫≠n/huy·ªán --</option>
            <option *ngFor="let c of pickupCommunes" [value]="c._id">{{ c.name }}</option>
          </select>

          <input type="text" class="form-control" formControlName="pickupDetailAddress" (input)="updatePickupMap()" placeholder="Nh·∫≠p ƒë·ªãa ch·ªâ chi ti·∫øt" />

          <label class="form-label fw-semibold mt-3">üìç Ch·ªçn v·ªã tr√≠ l·∫•y h√†ng tr√™n b·∫£n ƒë·ªì</label>
          <app-map-picker #pickupMap (locationSelect)="setPickupLocation($event)"></app-map-picker>
        </div>
      </div>

      <!-- Ng∆∞·ªùi nh·∫≠n + Delivery -->
      <div class="col-md-6">
        <div class="mb-3">
          <label class="form-label fw-semibold">Ng∆∞·ªùi nh·∫≠n</label>
          <input type="text" class="form-control" formControlName="receiverName" placeholder="Nh·∫≠p t√™n ng∆∞·ªùi nh·∫≠n" />
        </div>

        <div class="mb-3">
          <label class="form-label fw-semibold">SƒêT ng∆∞·ªùi nh·∫≠n</label>
          <input type="text" class="form-control" formControlName="receiverPhone" placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i" />
        </div>

        <div class="mb-3">
          <label class="form-label fw-semibold">ƒê·ªãa ch·ªâ giao h√†ng</label>
          <select class="form-select mb-2" formControlName="deliveryProvinceId" (change)="onDeliveryProvinceChange()">
            <option value="">-- Ch·ªçn t·ªânh/th√†nh ph·ªë --</option>
            <option *ngFor="let p of provinces" [value]="p._id">{{ p.name }}</option>
          </select>

          <select class="form-select mb-2" formControlName="deliveryCommuneId">
            <option value="">-- Ch·ªçn qu·∫≠n/huy·ªán --</option>
            <option *ngFor="let c of deliveryCommunes" [value]="c._id">{{ c.name }}</option>
          </select>

          <input type="text" class="form-control" formControlName="deliveryDetailAddress" (input)="updateDeliveryMap()" placeholder="Nh·∫≠p ƒë·ªãa ch·ªâ chi ti·∫øt" />

          <label class="form-label fw-semibold mt-3">üìç Ch·ªçn v·ªã tr√≠ giao h√†ng tr√™n b·∫£n ƒë·ªì</label>
          <app-map-picker #deliveryMap (locationSelect)="setDeliveryLocation($event)"></app-map-picker>
        </div>

        <div class="mb-3">
          <label class="form-label fw-semibold">T·ªïng gi√° tr·ªã (VNƒê)</label>
          <input type="number" class="form-control" formControlName="totalPrice" placeholder="Nh·∫≠p t·ªïng gi√° tr·ªã" />
        </div>
      </div>

      <div class="col-12 mt-3">
        <button class="btn btn-primary" [disabled]="loading || orderForm.invalid">
          <span *ngIf="!loading">C·∫≠p nh·∫≠t ƒë∆°n h√†ng</span>
          <span *ngIf="loading" class="spinner-border spinner-border-sm"></span>
        </button>
      </div>
    </div>
  </form>
</div>
